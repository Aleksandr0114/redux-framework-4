!function(e){"use strict";var t=[],a=!1,r=!0;redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{},redux.field_objects.typography.init=function(s,o){s||(s=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(s).each(function(){var s=e(this),o=s;s.hasClass("redux-field-container")||(o=s.parents(".redux-field-container:first")),o.is(":hidden")||o.hasClass("redux-field-init")&&(o.removeClass("redux-field-init"),void 0===redux.field_objects.pro&&(r=!1),s.each(function(){e(this).find(".redux-typography-container").each(function(){var o,p,i,d,n,y,l=e(this).find(".redux-typography-family"),u=l.data("value"),h=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),g=e("#"+h+" .redux-typography-google").val(),f=[],c=[],x=e("#"+h+" .redux-typography-font-family").data("user-fonts");if(void 0===u?l=e(this):""!==u&&e(l).val(u),x=x?1:0,g=g?1:0,void 0!==redux.optName.customfonts&&f.push(redux.optName.customfonts),void 0!==redux.optName.typekitfonts&&f.push(redux.optName.typekitfonts),void 0!==redux.optName.stdfonts&&0===x&&f.push(redux.optName.stdfonts),1===x){for(o in redux.optName.typography[h])if(redux.optName.typography[h].hasOwnProperty(o))for(i in p=redux.optName.typography[h].std_font)p.hasOwnProperty(i)&&c.push({id:i,text:i,"data-google":"false"});d={text:"Standard Fonts",children:c},f.push(d)}(1===g||!0===g&&void 0!==redux.optName.googlefonts)&&f.push(redux.optName.googlefonts),y=f,n=e(this).find(".redux-typography-family").data("value"),e(this).find(".redux-typography-family").select2({data:y}),e(this).find(".redux-typography-family").val(n).trigger("change"),s.find(".redux-typography-family").hasClass("redux-typography-family")||s.find(".redux-typography-style").select2(),e(this).find(".redux-typography-align").select2(),e(this).find(".redux-typography-family-backup").select2(),e(this).find(".redux-typography-transform").select2(),e(this).find(".redux-typography-font-variant").select2(),e(this).find(".redux-typography-decoration").select2(),redux.field_objects.typography.select(l,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var s,o,p=e(this).attr("id"),i=e("#"+p);e(this).hasClass("redux-typography-family")?i.val()&&(o=(s=e(this).select2("data"))?s[0].text:null,i.data("value",o),t=s[0],a=!0,redux.field_objects.typography.select(i,!0,!1,o,!0)):(r=i.val(),i.data("value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(i.find('option[selected="selected"]').removeAttr("selected"),i.find('option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&i.siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),e(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),r&&(redux.field_objects.pro.typography.fieldChange(e(this)),redux.field_objects.pro.typography.colorPicker(e(this))),e(this).find(".redux-typography-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(){var t,a,r=e(this).data("select2").options;r.set("disabled",!0),setTimeout(function(){r.set("disabled",!1)},1),t=e(this).attr("id"),(a=e("#"+t)).data("value",""),e(this).hasClass("redux-typography-family")?(e(this).val(null).trigger("change"),redux.field_objects.typography.select(a,!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+t+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&a.siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&a.val(null).trigger("change"),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(e(this)),window.onbeforeunload=null})}))})},redux.field_objects.typography.updates=function(t){t.find(".update-google-fonts").bind("click",function(a){var r=e(this).data("action"),s=e(this).parent().parent(),o=s.attr("data-nonce");return s.find("p").text(redux_typography_ajax.update_google_fonts.updating),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.updating),s.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),e.ajax({type:"post",dataType:"json",url:redux_typography_ajax.ajaxurl,data:{action:"redux_update_google_fonts",nonce:o,data:r},error:function(e){var a;console.log(e),s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),(a=e.error)&&(a=': "'+a+'"'),s.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",r).replace("|msg",a)),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(t)},success:function(a){var o;console.log(a),"success"===a.status?(s.find("p").html(redux_typography_ajax.update_google_fonts.success),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.success),s.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),e(".redux-update-google-fonts").not(".notice-success").remove()):(s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),(o=a.error)&&(o=': "'+o+'"'),s.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",r).replace("|msg",o)),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(t))}}),a.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&(a+=1);return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&!1!==e&&0!==e&&("true"===e||"1"===e||!0===e||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";return""!==e&&(e=e.replace("#",""),t=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=128?"#444444":"#ffffff"),t},redux.field_objects.typography.select=function(s,o,p,i,d){var n,y,l,u,h,g,f,c,x,v,m,b,_,j,C,w,k,N,z,O=!1,I="",B='<option value=""></option>',P="";void 0===(n=e(s).parents(".redux-container-typography:first").data("id"))&&(n=e(s).data("id")),y=e("#"+n),(l=e("#"+n+"-family").val())||(l=null),i&&(l=i),h=y.find("select.redux-typography-family-backup").val(),g=y.find(".redux-typography-size").val(),f=y.find(".redux-typography-height").val(),c=y.find(".redux-typography-word").val(),x=y.find(".redux-typography-letter").val(),v=y.find("select.redux-typography-align").val(),m=y.find("select.redux-typography-transform").val(),b=y.find("select.redux-typography-font-variant").val(),_=y.find("select.redux-typography-decoration").val(),j=y.find("select.redux-typography-style").val(),C=y.find("select.redux-typography-subsets").val(),w=y.find(".redux-typography-color").val(),k=y.data("units"),!0===a?(u=redux.field_objects.typography.makeBool(t["data-google"]),y.find(".redux-typography-google-font").val(u)):u=redux.field_objects.typography.makeBool(y.find(".redux-typography-google-font").val()),d&&(y.hasClass("typography-initialized")||(j=y.find("select.redux-typography-style").data("value"),C=y.find("select.redux-typography-subsets").data("value"),""!==j&&(j=String(j)),void 0!==typeof C&&(C=String(C))),void 0===redux.optName.fonts.google&&(u=!1),!0===u&&l in redux.optName.fonts.google?I=redux.optName.fonts.google[l]:void 0!==redux.optName.fonts.typekit&&l in redux.optName.fonts.typekit?(O=!0,I=redux.optName.fonts.typekit[l]):I={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(s).hasClass("redux-typography-subsets")&&y.find("input.typography-subsets").val(C),e(s).hasClass("redux-typography-family")?(!0===u?(e.each(I.variants,function(e,t){t.id===j||1===redux.field_objects.typography.size(I.variants)?(P=' selected="selected"',j=t.id):P="",B+='<option value="'+t.id+'"'+P+">"+t.name.replace(/\+/g," ")+"</option>"}),p&&y.find(".redux-typography-style").select2("destroy"),y.find(".redux-typography-style").html(B).select2(),P="",B='<option value=""></option>',e.each(I.subsets,function(e,t){C===t.id||1===redux.field_objects.typography.size(I.subsets)?(P=' selected="selected"',C=t.id,y.find("input.typography-subsets").val(C)):P="",B+='<option value="'+t.id+'"'+P+">"+t.name.replace(/\+/g," ")+"</option>"}),p&&y.find(".redux-typography-subsets").select2("destroy"),y.find(".redux-typography-subsets").html(B).select2(),y.find(".redux-typography-subsets").parent().fadeIn("fast"),y.find(".typography-family-backup").fadeIn("fast")):!0===O?(e.each(I.variants,function(e,t){j===t.id||1===redux.field_objects.typography.size(I.variants)?(P=' selected="selected"',j=t.id):P="",B+='<option value="'+t.id+'"'+P+">"+t.name.replace(/\+/g," ")+"</option>"}),y.find(".redux-typography-style").select2("destroy"),y.find(".redux-typography-style").html(B).select2(),y.find(".redux-typography-subsets").parent().fadeOut("fast"),y.find(".typography-family-backup").fadeOut("fast")):I&&(e.each(I,function(e,t){j===e||"normal"===e?(P=' selected="selected"',y.find(".typography-style select2-selection__rendered").text(t)):P="",B+='<option value="'+e+'"'+P+">"+t.replace("+"," ")+"</option>"}),p&&y.find(".redux-typography-style").select2("destroy"),y.find(".redux-typography-style").html(B).select2(),y.find(".redux-typography-subsets").parent().fadeOut("fast"),y.find(".typography-family-backup").fadeOut("fast")),y.find(".redux-typography-font-family").val(l)):e(s).hasClass("redux-typography-family-backup")&&""!==h&&y.find(".redux-typography-font-family-backup").val(h)),d&&(0===y.find("select.redux-typography-style option[value='"+j+"']").length?(j="",y.find("select.redux-typography-style").val("").trigger("change")):"400"===j&&y.find("select.redux-typography-style").val(j).trigger("change"),0===y.find("select.redux-typography-subsets option[value='"+C+"']").length&&(C="",y.find("select.redux-typography-subsets").val("").trigger("change"),y.find("input.typography-subsets").val(C))),e("."+("style_link_"+n)).remove(),null!==l&&"inherit"!==l&&y.hasClass("typography-initialized")&&(N=l.replace(/\s+/g,"+"),!0===u?(z=N,j&&""!==j&&(z+=":"+j.replace(/\-/g," ")),C&&""!==C&&(z+="&subset="+C),!1===a&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[z]}}),y.find(".redux-typography-google").val(!0)):y.find(".redux-typography-google").val(!1)),-1!==j.indexOf("italic")?(y.find(".typography-preview").css("font-style","italic"),y.find(".typography-font-style").val("italic"),j=j.replace("italic","")):(y.find(".typography-preview").css("font-style","normal"),y.find(".typography-font-style").val("")),y.find(".typography-font-weight").val(j),Boolean(y.find(".redux-typography-height").data("allow-empty"))||f||(f=g),""===g||void 0===g?y.find(".typography-font-size").val(""):y.find(".typography-font-size").val(g+k),""===f||void 0===f?y.find(".typography-line-height").val(""):y.find(".typography-line-height").val(f+k),""===c||void 0===c?y.find(".typography-word-spacing").val(""):y.find(".typography-word-spacing").val(c+k),""===x||void 0===x?y.find(".typography-letter-spacing").val(""):y.find(".typography-letter-spacing").val(x+k),r&&redux.field_objects.pro.typography.select(n),y.hasClass("typography-initialized")&&(0===y.find(".typography-preview").data("preview-size")&&y.find(".typography-preview").css("font-size",g+k),y.find(".typography-preview").css({"font-weight":j,"text-align":v,"font-family":l+", sans-serif"}),"none"===l&&""===l&&y.find(".typography-preview").css("font-family","inherit"),y.find(".typography-preview").css({"line-height":f+k,"word-spacing":c+k,"letter-spacing":x+k}),w&&y.find(".typography-preview").css("color",w),r&&redux.field_objects.typography.previewShadow(n),y.find(".typography-style select2-selection__rendered").text(y.find(".redux-typography-style option:selected").text()),y.find(".typography-script select2-selection__rendered").text(y.find(".redux-typography-subsets option:selected").text()),v&&y.find(".typography-preview").css("text-align",v),m&&y.find(".typography-preview").css("text-transform",m),b&&y.find(".typography-preview").css("font-variant",b),_&&y.find(".typography-preview").css("text-decoration",_),y.find(".typography-preview").slideDown()),y.hasClass("typography-initialized")||y.addClass("typography-initialized"),a=!1,o||redux_change(s)}}(jQuery);