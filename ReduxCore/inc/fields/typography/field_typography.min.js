!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var t=[],a=!1;redux.field_objects.typography.init=function(r,s){r||(r=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(r).each(function(){var r=e(this),s=r;r.hasClass("redux-field-container")||(s=r.parents(".redux-field-container:first")),s.is(":hidden")||s.hasClass("redux-field-init")&&(s.removeClass("redux-field-init"),r.each(function(){r.parents(".redux-container").data("opt-name");e(this).find(".redux-typography-container").each(function(){var s=e(this).find(".redux-typography-family"),o=s.data("value");void 0===o?s=e(this):""!==o&&e(s).val(o);var p=[{id:"none",text:"none"}],i=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),y=e("#"+i+" .redux-typography-font-family").data("user-fonts");y=y?1:0;var l=e("#"+i+" .redux-typography-google").val();l=l?1:0;var d=[];if(void 0!==redux.optName.customfonts&&d.push(redux.optName.customfonts),void 0!==redux.optName.typekitfonts&&d.push(redux.optName.typekitfonts),void 0!==redux.optName.stdfonts&&0===y&&d.push(redux.optName.stdfonts),1===y){var n=[];for(var u in redux.optName.typography[i]){var g=redux.optName.typography[i].std_font;for(var h in g)g.hasOwnProperty(h)&&n.push({id:h,text:h,"data-google":"false"})}var c={text:"Standard Fonts",children:n};d.push(c)}(1===l||l===!0&&void 0!==redux.optName.googlefonts)&&d.push(redux.optName.googlefonts),p=d;var f=e(this).find(".redux-typography-family").data("value");e(this).find(".redux-typography-family").select2({data:p}),e(this).find(".redux-typography-family").val(f).trigger("change");var x=r.find(".redux-typography-family");x.hasClass("redux-typography-family")||r.find(".redux-typography-style").select2(),e(this).find(".redux-typography-align").select2(),e(this).find(".redux-typography-family-backup").select2(),e(this).find(".redux-typography-transform").select2(),e(this).find(".redux-typography-font-variant").select2(),e(this).find(".redux-typography-decoration").select2(),redux.field_objects.typography.select(s,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var s=e(this).attr("id");if(e(this).hasClass("redux-typography-family")){if(e("#"+s).val()){var o,p=e(this).select2("data");o=p?p[0].text:null,e("#"+s).data("value",o),t=p[0],a=!0,redux.field_objects.typography.select(e("#"+s),!0,!1,o,!0)}}else r=e("#"+s).val(),e("#"+s).data("value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(e("#"+s+' option[selected="selected"]').removeAttr("selected"),e("#"+s+' option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&e("#"+s).siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1)}),e(this).find(".redux-typography-margin-top, .redux-typography-margin-bottom, .redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),e(this).find(".redux-typography-color, .redux-typography-shadow-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(t,a){var r=e(this).attr("id");e("#"+r).data("value",""),e(this).hasClass("redux-typography-family")?(e(this).val(null).trigger("change"),redux.field_objects.typography.select(e("#"+r),!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+r+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&e("#"+r).siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&e("#"+r).val(null).trigger("change"),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(e(this)),window.onbeforeunload=null})}))})},redux.field_objects.typography.updates=function(t){t.find(".update-google-fonts").bind("click",function(a){var r=e(this).data("action"),s=e(this).parent().parent(),o=s.attr("data-nonce");return s.find("p").text(redux_ajax_script.update_google_fonts.updating),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.updating),s.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),e.ajax({type:"post",dataType:"json",url:redux_ajax_script.ajaxurl,data:{action:"redux_update_google_fonts",nonce:o,data:r},error:function(e){console.log(e),s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),s.find("p").html(redux_ajax_script.update_google_fonts.error.replace("%s",r)),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.error),redux.field_objects.typography.updates(t)},success:function(a){console.log(a),"success"===a.status?(s.find("p").html(redux_ajax_script.update_google_fonts.success),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.success),s.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),e(".redux-update-google-fonts").not(".notice-success").remove()):(s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),s.find("p").html(redux_ajax_script.update_google_fonts.error.replace("%s",r)),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.error),redux.field_objects.typography.updates(t))}}),a.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&e!==!1&&0!==e&&("true"===e||"1"===e||e===!0||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";if(""!==e){e=e.replace("#","");var a=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),s=parseInt(e.substr(4,2),16),o=(299*a+587*r+114*s)/1e3;t=o>=128?"#444444":"#ffffff"}return t},redux.field_objects.typography.select=function(r,s,o,p,i){var y;y=e(r).parents(".redux-container-typography:first").data("id"),void 0===y&&(y=e(r).data("id"));var l=e("#"+y+"-family").val();l||(l=null),p&&(l=p);var d,n=e("#"+y+" select.redux-typography-family-backup").val(),u=e("#"+y+" .redux-typography-size").val(),g=e("#"+y+" .redux-typography-margin-top").val(),h=e("#"+y+" .redux-typography-margin-bottom").val(),c=e("#"+y+" .redux-typography-height").val(),f=e("#"+y+" .redux-typography-word").val(),x=e("#"+y+" .redux-typography-letter").val(),v=e("#"+y+" select.redux-typography-align").val(),m=e("#"+y+" select.redux-typography-transform").val(),b=e("#"+y+" select.redux-typography-font-variant").val(),_=e("#"+y+" select.redux-typography-decoration").val(),w=e("#"+y+" select.redux-typography-style").val(),C=e("#"+y+" select.redux-typography-subsets").val(),j=e("#"+y+" .redux-typography-color").val(),k=e("#"+y).data("units");if(a===!0?(d=redux.field_objects.typography.makeBool(t["data-google"]),e("#"+y+" .redux-typography-google-font").val(d)):d=redux.field_objects.typography.makeBool(e("#"+y+" .redux-typography-google-font").val()),i){e("#"+y).hasClass("typography-initialized")||(w=e("#"+y+" select.redux-typography-style").data("value"),C=e("#"+y+" select.redux-typography-subsets").data("value"),""!==w&&(w=String(w)),void 0!==typeof C&&(C=String(C))),void 0===redux.optName.fonts.google&&(d=!1);var N=!1,z="";if(d===!0&&l in redux.optName.fonts.google?z=redux.optName.fonts.google[l]:void 0!==redux.optName.fonts.typekit&&l in redux.optName.fonts.typekit?(N=!0,z=redux.optName.fonts.typekit[l]):z={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(r).hasClass("redux-typography-subsets")&&e("#"+y+" input.typography-subsets").val(C),e(r).hasClass("redux-typography-family")){var I='<option value=""></option>',O="";d===!0?(e.each(z.variants,function(e,t){t.id===w||1===redux.field_objects.typography.size(z.variants)?(O=' selected="selected"',w=t.id):O="",I+='<option value="'+t.id+'"'+O+">"+t.name.replace(/\+/g," ")+"</option>"}),o&&e("#"+y+" .redux-typography-style").select2("destroy"),e("#"+y+" .redux-typography-style").html(I),e("#"+y+" .redux-typography-style").select2(),O="",I='<option value=""></option>',e.each(z.subsets,function(t,a){a.id===C||1===redux.field_objects.typography.size(z.subsets)?(O=' selected="selected"',C=a.id,e("#"+y+" input.typography-subsets").val(C)):O="",I+='<option value="'+a.id+'"'+O+">"+a.name.replace(/\+/g," ")+"</option>"}),o&&e("#"+y+" .redux-typography-subsets").select2("destroy"),e("#"+y+" .redux-typography-subsets").html(I),e("#"+y+" .redux-typography-subsets").select2(),e("#"+y+" .redux-typography-subsets").parent().fadeIn("fast"),e("#"+y+" .typography-family-backup").fadeIn("fast")):N===!0?(e.each(z.variants,function(e,t){t.id===w||1===redux.field_objects.typography.size(z.variants)?(O=' selected="selected"',w=t.id):O="",I+='<option value="'+t.id+'"'+O+">"+t.name.replace(/\+/g," ")+"</option>"}),e("#"+y+" .redux-typography-style").select2("destroy"),e("#"+y+" .redux-typography-style").html(I),e("#"+y+" .redux-typography-style").select2(),e("#"+y+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+y+" .typography-family-backup").fadeOut("fast")):z&&(e.each(z,function(t,a){t===w||"normal"===t?(O=' selected="selected"',e("#"+y+" .typography-style select2-selection__rendered").text(a)):O="",I+='<option value="'+t+'"'+O+">"+a.replace("+"," ")+"</option>"}),o&&e("#"+y+" .redux-typography-style").select2("destroy"),e("#"+y+" .redux-typography-style").html(I),e("#"+y+" .redux-typography-style").select2(),e("#"+y+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+y+" .typography-family-backup").fadeOut("fast")),e("#"+y+" .redux-typography-font-family").val(l)}else e(r).hasClass("redux-typography-family-backup")&&""!==n&&e("#"+y+" .redux-typography-font-family-backup").val(n)}i&&(0===e("#"+y+" select.redux-typography-style option[value='"+w+"']").length?(w="",e("#"+y+" select.redux-typography-style").val("").trigger("change")):"400"===w&&e("#"+y+" select.redux-typography-style").val(w).trigger("change"),0===e("#"+y+" select.redux-typography-subsets option[value='"+C+"']").length&&(C="",e("#"+y+" select.redux-typography-subsets").val("").trigger("change"),e("#"+y+" input.typography-subsets").val(C)));var B="style_link_"+y;if(e("."+B).remove(),null!==l&&"inherit"!==l&&e("#"+y).hasClass("typography-initialized")){var F=l.replace(/\s+/g,"+");if(d===!0){var S=F;w&&""!==w&&(S+=":"+w.replace(/\-/g," ")),C&&""!==C&&(S+="&subset="+C),a===!1&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[S]}}),e("#"+y+" .redux-typography-google").val(!0)}else e("#"+y+" .redux-typography-google").val(!1)}if(w.indexOf("italic")!==-1?(e("#"+y+" .typography-preview").css("font-style","italic"),e("#"+y+" .typography-font-style").val("italic"),w=w.replace("italic","")):(e("#"+y+" .typography-preview").css("font-style","normal"),e("#"+y+" .typography-font-style").val("")),e("#"+y+" .typography-font-weight").val(w),c||(c=u),""===u||void 0===u?e("#"+y+" .typography-font-size").val(""):e("#"+y+" .typography-font-size").val(u+k),""===g||void 0===g?e("#"+y+" .typography-margin-top").val(""):e("#"+y+" .typography-margin-top").val(g),""===h||void 0===h?e("#"+y+" .typography-margin-bottom").val(""):e("#"+y+" .typography-margin-bottom").val(h),""===c||void 0===c?e("#"+y+" .typography-line-height").val(""):e("#"+y+" .typography-line-height").val(c+k),""===f||void 0===f?e("#"+y+" .typography-word-spacing").val(""):e("#"+y+" .typography-word-spacing").val(f+k),""===x||void 0===x?e("#"+y+" .typography-letter-spacing").val(""):e("#"+y+" .typography-letter-spacing").val(x+k),e("#"+y).hasClass("typography-initialized")){var P=e("#"+y+" .typography-preview").data("preview-size");0===P&&e("#"+y+" .typography-preview").css("font-size",u+k),e("#"+y+" .typography-preview").css("font-weight",w),e("#"+y+" .typography-preview").css("text-align",v),e("#"+y+" .typography-preview").css("font-family",l+", sans-serif"),"none"===l&&""===l&&e("#"+y+" .typography-preview").css("font-family","inherit"),e("#"+y+" .typography-preview").css("line-height",c+k),e("#"+y+" .typography-preview").css("word-spacing",f+k),e("#"+y+" .typography-preview").css("letter-spacing",x+k),j&&e("#"+y+" .typography-preview").css("color",j),e("#"+y+" .typography-style select2-selection__rendered").text(e("#"+y+" .redux-typography-style option:selected").text()),e("#"+y+" .typography-script select2-selection__rendered").text(e("#"+y+" .redux-typography-subsets option:selected").text()),v&&e("#"+y+" .typography-preview").css("text-align",v),m&&e("#"+y+" .typography-preview").css("text-transform",m),b&&e("#"+y+" .typography-preview").css("font-variant",b),_&&e("#"+y+" .typography-preview").css("text-decoration",_),e("#"+y+" .typography-preview").slideDown()}e("#"+y).hasClass("typography-initialized")||e("#"+y).addClass("typography-initialized"),a=!1,s||redux_change(r)}}(jQuery);