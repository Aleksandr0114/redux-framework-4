!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var t=[],a=!1;redux.field_objects.typography.init=function(r,p){r||(r=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(r).each(function(){var r=e(this),p=r;r.hasClass("redux-field-container")||(p=r.parents(".redux-field-container:first")),p.is(":hidden")||p.hasClass("redux-field-init")&&(p.removeClass("redux-field-init"),r.each(function(){r.parents(".redux-container").data("opt-name");e(this).find(".redux-typography-container").each(function(){var p=e(this).find(".redux-typography-family"),o=p.data("value");void 0===o?p=e(this):""!==o&&e(p).val(o);var s=[{id:"none",text:"none"}],y=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),i=e("#"+y+" .redux-typography-font-family").data("user-fonts");i=i?1:0;var l=e("#"+y+" .redux-typography-google").val();l=l?1:0;var d=[];if(void 0!==redux.optName.customfonts&&d.push(redux.optName.customfonts),void 0!==redux.optName.typekitfonts&&d.push(redux.optName.typekitfonts),void 0!==redux.optName.stdfonts&&0===i&&d.push(redux.optName.stdfonts),1===i){var h=[];for(var n in redux.optName.typography[y]){var u=redux.optName.typography[y].std_font;for(var g in u)u.hasOwnProperty(g)&&h.push({id:g,text:g,"data-google":"false"})}var c={text:"Standard Fonts",children:h};d.push(c)}(1===l||l===!0&&void 0!==redux.optName.googlefonts)&&d.push(redux.optName.googlefonts),s=d;var f=e(this).find(".redux-typography-family").data("value");e(this).find(".redux-typography-family").select2({data:s}),e(this).find(".redux-typography-family").val(f).trigger("change");var x=r.find(".redux-typography-family");x.hasClass("redux-typography-family")||r.find(".redux-typography-style").select2(),e(this).find(".redux-typography-align").select2(),e(this).find(".redux-typography-family-backup").select2(),e(this).find(".redux-typography-transform").select2(),e(this).find(".redux-typography-font-variant").select2(),e(this).find(".redux-typography-decoration").select2(),redux.field_objects.typography.select(p,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var p=e(this).attr("id");if(e(this).hasClass("redux-typography-family")){if(e("#"+p).val()){var o,s=e(this).select2("data");o=s?s[0].text:null,e("#"+p).data("value",o),t=s[0],a=!0,redux.field_objects.typography.select(e("#"+p),!0,!1,o,!0)}}else r=e("#"+p).val(),e("#"+p).data("value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(e("#"+p+' option[selected="selected"]').removeAttr("selected"),e("#"+p+' option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&e("#"+p).siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1)}),e(this).find(".redux-typography-margin-top, .redux-typography-margin-bottom, .redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),e(this).find(".redux-typography-color, .redux-typography-shadow-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(t,a){var r=e(this).attr("id");e("#"+r).data("value",""),e(this).hasClass("redux-typography-family")?(e(this).val(null).trigger("change"),redux.field_objects.typography.select(e("#"+r),!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+r+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&e("#"+r).siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&e("#"+r).val(null).trigger("change"),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),window.onbeforeunload=null})}))})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&e!==!1&&0!==e&&("true"===e||"1"===e||e===!0||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";if(""!==e){e=e.replace("#","");var a=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),p=parseInt(e.substr(4,2),16),o=(299*a+587*r+114*p)/1e3;t=o>=128?"#444444":"#ffffff"}return t},redux.field_objects.typography.select=function(r,p,o,s,y){var i;i=e(r).parents(".redux-container-typography:first").data("id"),void 0===i&&(i=e(r).data("id"));var l=e("#"+i+"-family").val();l||(l=null),s&&(l=s);var d,h=e("#"+i+" select.redux-typography-family-backup").val(),n=e("#"+i+" .redux-typography-size").val(),u=e("#"+i+" .redux-typography-margin-top").val(),g=e("#"+i+" .redux-typography-margin-bottom").val(),c=e("#"+i+" .redux-typography-height").val(),f=e("#"+i+" .redux-typography-word").val(),x=e("#"+i+" .redux-typography-letter").val(),v=e("#"+i+" select.redux-typography-align").val(),m=e("#"+i+" select.redux-typography-transform").val(),b=e("#"+i+" select.redux-typography-font-variant").val(),w=e("#"+i+" select.redux-typography-decoration").val(),C=e("#"+i+" select.redux-typography-style").val(),_=e("#"+i+" select.redux-typography-subsets").val(),j=e("#"+i+" .redux-typography-color").val(),k=e("#"+i).data("units");if(a===!0?(d=redux.field_objects.typography.makeBool(t["data-google"]),e("#"+i+" .redux-typography-google-font").val(d)):d=redux.field_objects.typography.makeBool(e("#"+i+" .redux-typography-google-font").val()),y){e("#"+i).hasClass("typography-initialized")||(C=e("#"+i+" select.redux-typography-style").data("value"),_=e("#"+i+" select.redux-typography-subsets").data("value"),""!==C&&(C=String(C)),void 0!==typeof _&&(_=String(_))),void 0===redux.optName.fonts.google&&(d=!1);var N=!1,z="";if(d===!0&&l in redux.optName.fonts.google?z=redux.optName.fonts.google[l]:void 0!==redux.optName.fonts.typekit&&l in redux.optName.fonts.typekit?(N=!0,z=redux.optName.fonts.typekit[l]):z={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(r).hasClass("redux-typography-subsets")&&e("#"+i+" input.typography-subsets").val(_),e(r).hasClass("redux-typography-family")){var I='<option value=""></option>',O="";d===!0?(e.each(z.variants,function(e,t){t.id===C||1===redux.field_objects.typography.size(z.variants)?(O=' selected="selected"',C=t.id):O="",I+='<option value="'+t.id+'"'+O+">"+t.name.replace(/\+/g," ")+"</option>"}),o&&e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(I),e("#"+i+" .redux-typography-style").select2(),O="",I='<option value=""></option>',e.each(z.subsets,function(t,a){a.id===_||1===redux.field_objects.typography.size(z.subsets)?(O=' selected="selected"',_=a.id,e("#"+i+" input.typography-subsets").val(_)):O="",I+='<option value="'+a.id+'"'+O+">"+a.name.replace(/\+/g," ")+"</option>"}),o&&e("#"+i+" .redux-typography-subsets").select2("destroy"),e("#"+i+" .redux-typography-subsets").html(I),e("#"+i+" .redux-typography-subsets").select2(),e("#"+i+" .redux-typography-subsets").parent().fadeIn("fast"),e("#"+i+" .typography-family-backup").fadeIn("fast")):N===!0?(e.each(z.variants,function(e,t){t.id===C||1===redux.field_objects.typography.size(z.variants)?(O=' selected="selected"',C=t.id):O="",I+='<option value="'+t.id+'"'+O+">"+t.name.replace(/\+/g," ")+"</option>"}),e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(I),e("#"+i+" .redux-typography-style").select2(),e("#"+i+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+i+" .typography-family-backup").fadeOut("fast")):z&&(e.each(z,function(t,a){t===C||"normal"===t?(O=' selected="selected"',e("#"+i+" .typography-style select2-selection__rendered").text(a)):O="",I+='<option value="'+t+'"'+O+">"+a.replace("+"," ")+"</option>"}),o&&e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(I),e("#"+i+" .redux-typography-style").select2(),e("#"+i+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+i+" .typography-family-backup").fadeOut("fast")),e("#"+i+" .redux-typography-font-family").val(l)}else e(r).hasClass("redux-typography-family-backup")&&""!==h&&e("#"+i+" .redux-typography-font-family-backup").val(h)}y&&(0===e("#"+i+" select.redux-typography-style option[value='"+C+"']").length?(C="",e("#"+i+" select.redux-typography-style").val("").trigger("change")):"400"===C&&e("#"+i+" select.redux-typography-style").val(C).trigger("change"),0===e("#"+i+" select.redux-typography-subsets option[value='"+_+"']").length&&(_="",e("#"+i+" select.redux-typography-subsets").val("").trigger("change"),e("#"+i+" input.typography-subsets").val(_)));var B="style_link_"+i;if(e("."+B).remove(),null!==l&&"inherit"!==l&&e("#"+i).hasClass("typography-initialized")){var F=l.replace(/\s+/g,"+");if(d===!0){var S=F;C&&""!==C&&(S+=":"+C.replace(/\-/g," ")),_&&""!==_&&(S+="&subset="+_),a===!1&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[S]}}),e("#"+i+" .redux-typography-google").val(!0)}else e("#"+i+" .redux-typography-google").val(!1)}if(C.indexOf("italic")!==-1?(e("#"+i+" .typography-preview").css("font-style","italic"),e("#"+i+" .typography-font-style").val("italic"),C=C.replace("italic","")):(e("#"+i+" .typography-preview").css("font-style","normal"),e("#"+i+" .typography-font-style").val("")),e("#"+i+" .typography-font-weight").val(C),c||(c=n),""===n||void 0===n?e("#"+i+" .typography-font-size").val(""):e("#"+i+" .typography-font-size").val(n+k),""===u||void 0===u?e("#"+i+" .typography-margin-top").val(""):e("#"+i+" .typography-margin-top").val(u),""===g||void 0===g?e("#"+i+" .typography-margin-bottom").val(""):e("#"+i+" .typography-margin-bottom").val(g),""===c||void 0===c?e("#"+i+" .typography-line-height").val(""):e("#"+i+" .typography-line-height").val(c+k),""===f||void 0===f?e("#"+i+" .typography-word-spacing").val(""):e("#"+i+" .typography-word-spacing").val(f+k),""===x||void 0===x?e("#"+i+" .typography-letter-spacing").val(""):e("#"+i+" .typography-letter-spacing").val(x+k),e("#"+i).hasClass("typography-initialized")){var P=e("#"+i+" .typography-preview").data("preview-size");"0"===P&&e("#"+i+" .typography-preview").css("font-size",n+k),e("#"+i+" .typography-preview").css("font-weight",C),e("#"+i+" .typography-preview").css("font-family",l+", sans-serif"),"none"===l&&""===l&&e("#"+i+" .typography-preview").css("font-family","inherit"),e("#"+i+" .typography-preview").css("line-height",c+k),e("#"+i+" .typography-preview").css("word-spacing",f+k),e("#"+i+" .typography-preview").css("letter-spacing",x+k),j&&e("#"+i+" .typography-preview").css("color",j),e("#"+i+" .typography-style select2-selection__rendered").text(e("#"+i+" .redux-typography-style option:selected").text()),e("#"+i+" .typography-script select2-selection__rendered").text(e("#"+i+" .redux-typography-subsets option:selected").text()),v&&e("#"+i+" .typography-preview").css("text-align",v),m&&e("#"+i+" .typography-preview").css("text-transform",m),b&&e("#"+i+" .typography-preview").css("font-variant",b),w&&e("#"+i+" .typography-preview").css("text-decoration",w),e("#"+i+" .typography-preview").slideDown()}e("#"+i).hasClass("typography-initialized")||e("#"+i).addClass("typography-initialized"),a=!1,p||redux_change(r)}}(jQuery);