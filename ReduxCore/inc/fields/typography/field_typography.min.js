!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var t=[],a=!1,r=!0;redux.field_objects.typography.init=function(s,o){s||(s=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(s).each(function(){var s=e(this),o=s;s.hasClass("redux-field-container")||(o=s.parents(".redux-field-container:first")),o.is(":hidden")||o.hasClass("redux-field-init")&&(o.removeClass("redux-field-init"),void 0===redux.field_objects.pro&&(r=!1),s.each(function(){s.parents(".redux-container").data("opt-name");e(this).find(".redux-typography-container").each(function(){var o=e(this).find(".redux-typography-family"),p=o.data("value");void 0===p?o=e(this):""!==p&&e(o).val(p);var i=[{id:"none",text:"none"}],y=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),l=e("#"+y+" .redux-typography-font-family").data("user-fonts");l=l?1:0;var d=e("#"+y+" .redux-typography-google").val();d=d?1:0;var n=[];if(void 0!==redux.optName.customfonts&&n.push(redux.optName.customfonts),void 0!==redux.optName.typekitfonts&&n.push(redux.optName.typekitfonts),void 0!==redux.optName.stdfonts&&0===l&&n.push(redux.optName.stdfonts),1===l){var u=[];for(var h in redux.optName.typography[y]){var g=redux.optName.typography[y].std_font;for(var c in g)g.hasOwnProperty(c)&&u.push({id:c,text:c,"data-google":"false"})}var f={text:"Standard Fonts",children:u};n.push(f)}(1===d||d===!0&&void 0!==redux.optName.googlefonts)&&n.push(redux.optName.googlefonts),i=n;var x=e(this).find(".redux-typography-family").data("value");e(this).find(".redux-typography-family").select2({data:i}),e(this).find(".redux-typography-family").val(x).trigger("change");var v=s.find(".redux-typography-family");v.hasClass("redux-typography-family")||s.find(".redux-typography-style").select2(),e(this).find(".redux-typography-align").select2(),e(this).find(".redux-typography-family-backup").select2(),e(this).find(".redux-typography-transform").select2(),e(this).find(".redux-typography-font-variant").select2(),e(this).find(".redux-typography-decoration").select2(),redux.field_objects.typography.select(o,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var s=e(this).attr("id");if(e(this).hasClass("redux-typography-family")){if(e("#"+s).val()){var o,p=e(this).select2("data");o=p?p[0].text:null,e("#"+s).data("value",o),t=p[0],a=!0,redux.field_objects.typography.select(e("#"+s),!0,!1,o,!0)}}else r=e("#"+s).val(),e("#"+s).data("value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(e("#"+s+' option[selected="selected"]').removeAttr("selected"),e("#"+s+' option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&e("#"+s).siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1)}),e(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),r&&(redux.field_objects.pro.typography.fieldChange(e(this)),redux.field_objects.pro.typography.colorPicker(e(this))),e(this).find(".redux-typography-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(t,a){var r=e(this).attr("id");e("#"+r).data("value",""),e(this).hasClass("redux-typography-family")?(e(this).val(null).trigger("change"),redux.field_objects.typography.select(e("#"+r),!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+r+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&e("#"+r).siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&e("#"+r).val(null).trigger("change"),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(e(this)),window.onbeforeunload=null})}))})},redux.field_objects.typography.updates=function(t){t.find(".update-google-fonts").bind("click",function(a){var r=e(this).data("action"),s=e(this).parent().parent(),o=s.attr("data-nonce");return s.find("p").text(redux_ajax_script.update_google_fonts.updating),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.updating),s.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),e.ajax({type:"post",dataType:"json",url:redux_ajax_script.ajaxurl,data:{action:"redux_update_google_fonts",nonce:o,data:r},error:function(e){console.log(e),s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),s.find("p").html(redux_ajax_script.update_google_fonts.error.replace("%s",r)),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.error),redux.field_objects.typography.updates(t)},success:function(a){console.log(a),"success"===a.status?(s.find("p").html(redux_ajax_script.update_google_fonts.success),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.success),s.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),e(".redux-update-google-fonts").not(".notice-success").remove()):(s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),s.find("p").html(redux_ajax_script.update_google_fonts.error.replace("%s",r)),s.find("p").attr("aria-label",redux_ajax_script.update_google_fonts.error),redux.field_objects.typography.updates(t))}}),a.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&e!==!1&&0!==e&&("true"===e||"1"===e||e===!0||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";if(""!==e){e=e.replace("#","");var a=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),s=parseInt(e.substr(4,2),16),o=(299*a+587*r+114*s)/1e3;t=o>=128?"#444444":"#ffffff"}return t},redux.field_objects.typography.select=function(s,o,p,i,y){var l;l=e(s).parents(".redux-container-typography:first").data("id"),void 0===l&&(l=e(s).data("id"));var d=e("#"+l+"-family").val();d||(d=null),i&&(d=i);var n,u=e("#"+l+" select.redux-typography-family-backup").val(),h=e("#"+l+" .redux-typography-size").val(),g=e("#"+l+" .redux-typography-height").val(),c=e("#"+l+" .redux-typography-word").val(),f=e("#"+l+" .redux-typography-letter").val(),x=e("#"+l+" select.redux-typography-align").val(),v=e("#"+l+" select.redux-typography-transform").val(),m=e("#"+l+" select.redux-typography-font-variant").val(),b=e("#"+l+" select.redux-typography-decoration").val(),_=e("#"+l+" select.redux-typography-style").val(),j=e("#"+l+" select.redux-typography-subsets").val(),w=e("#"+l+" .redux-typography-color").val(),C=e("#"+l).data("units");if(a===!0?(n=redux.field_objects.typography.makeBool(t["data-google"]),e("#"+l+" .redux-typography-google-font").val(n)):n=redux.field_objects.typography.makeBool(e("#"+l+" .redux-typography-google-font").val()),y){e("#"+l).hasClass("typography-initialized")||(_=e("#"+l+" select.redux-typography-style").data("value"),j=e("#"+l+" select.redux-typography-subsets").data("value"),""!==_&&(_=String(_)),void 0!==typeof j&&(j=String(j))),void 0===redux.optName.fonts.google&&(n=!1);var k=!1,N="";if(n===!0&&d in redux.optName.fonts.google?N=redux.optName.fonts.google[d]:void 0!==redux.optName.fonts.typekit&&d in redux.optName.fonts.typekit?(k=!0,N=redux.optName.fonts.typekit[d]):N={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(s).hasClass("redux-typography-subsets")&&e("#"+l+" input.typography-subsets").val(j),e(s).hasClass("redux-typography-family")){var z='<option value=""></option>',I="";n===!0?(e.each(N.variants,function(e,t){t.id===_||1===redux.field_objects.typography.size(N.variants)?(I=' selected="selected"',_=t.id):I="",z+='<option value="'+t.id+'"'+I+">"+t.name.replace(/\+/g," ")+"</option>"}),p&&e("#"+l+" .redux-typography-style").select2("destroy"),e("#"+l+" .redux-typography-style").html(z),e("#"+l+" .redux-typography-style").select2(),I="",z='<option value=""></option>',e.each(N.subsets,function(t,a){a.id===j||1===redux.field_objects.typography.size(N.subsets)?(I=' selected="selected"',j=a.id,e("#"+l+" input.typography-subsets").val(j)):I="",z+='<option value="'+a.id+'"'+I+">"+a.name.replace(/\+/g," ")+"</option>"}),p&&e("#"+l+" .redux-typography-subsets").select2("destroy"),e("#"+l+" .redux-typography-subsets").html(z),e("#"+l+" .redux-typography-subsets").select2(),e("#"+l+" .redux-typography-subsets").parent().fadeIn("fast"),e("#"+l+" .typography-family-backup").fadeIn("fast")):k===!0?(e.each(N.variants,function(e,t){t.id===_||1===redux.field_objects.typography.size(N.variants)?(I=' selected="selected"',_=t.id):I="",z+='<option value="'+t.id+'"'+I+">"+t.name.replace(/\+/g," ")+"</option>"}),e("#"+l+" .redux-typography-style").select2("destroy"),e("#"+l+" .redux-typography-style").html(z),e("#"+l+" .redux-typography-style").select2(),e("#"+l+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+l+" .typography-family-backup").fadeOut("fast")):N&&(e.each(N,function(t,a){t===_||"normal"===t?(I=' selected="selected"',e("#"+l+" .typography-style select2-selection__rendered").text(a)):I="",z+='<option value="'+t+'"'+I+">"+a.replace("+"," ")+"</option>"}),p&&e("#"+l+" .redux-typography-style").select2("destroy"),e("#"+l+" .redux-typography-style").html(z),e("#"+l+" .redux-typography-style").select2(),e("#"+l+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+l+" .typography-family-backup").fadeOut("fast")),e("#"+l+" .redux-typography-font-family").val(d)}else e(s).hasClass("redux-typography-family-backup")&&""!==u&&e("#"+l+" .redux-typography-font-family-backup").val(u)}y&&(0===e("#"+l+" select.redux-typography-style option[value='"+_+"']").length?(_="",e("#"+l+" select.redux-typography-style").val("").trigger("change")):"400"===_&&e("#"+l+" select.redux-typography-style").val(_).trigger("change"),0===e("#"+l+" select.redux-typography-subsets option[value='"+j+"']").length&&(j="",e("#"+l+" select.redux-typography-subsets").val("").trigger("change"),e("#"+l+" input.typography-subsets").val(j)));var O="style_link_"+l;if(e("."+O).remove(),null!==d&&"inherit"!==d&&e("#"+l).hasClass("typography-initialized")){var B=d.replace(/\s+/g,"+");if(n===!0){var S=B;_&&""!==_&&(S+=":"+_.replace(/\-/g," ")),j&&""!==j&&(S+="&subset="+j),a===!1&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[S]}}),e("#"+l+" .redux-typography-google").val(!0)}else e("#"+l+" .redux-typography-google").val(!1)}if(_.indexOf("italic")!==-1?(e("#"+l+" .typography-preview").css("font-style","italic"),e("#"+l+" .typography-font-style").val("italic"),_=_.replace("italic","")):(e("#"+l+" .typography-preview").css("font-style","normal"),e("#"+l+" .typography-font-style").val("")),e("#"+l+" .typography-font-weight").val(_),g||(g=h),""===h||void 0===h?e("#"+l+" .typography-font-size").val(""):e("#"+l+" .typography-font-size").val(h+C),""===g||void 0===g?e("#"+l+" .typography-line-height").val(""):e("#"+l+" .typography-line-height").val(g+C),""===c||void 0===c?e("#"+l+" .typography-word-spacing").val(""):e("#"+l+" .typography-word-spacing").val(c+C),""===f||void 0===f?e("#"+l+" .typography-letter-spacing").val(""):e("#"+l+" .typography-letter-spacing").val(f+C),r&&redux.field_objects.pro.typography.select(l),e("#"+l).hasClass("typography-initialized")){var F=e("#"+l+" .typography-preview").data("preview-size");0===F&&e("#"+l+" .typography-preview").css("font-size",h+C),e("#"+l+" .typography-preview").css("font-weight",_),e("#"+l+" .typography-preview").css("text-align",x),e("#"+l+" .typography-preview").css("font-family",d+", sans-serif"),"none"===d&&""===d&&e("#"+l+" .typography-preview").css("font-family","inherit"),e("#"+l+" .typography-preview").css("line-height",g+C),e("#"+l+" .typography-preview").css("word-spacing",c+C),e("#"+l+" .typography-preview").css("letter-spacing",f+C),w&&e("#"+l+" .typography-preview").css("color",w),r&&redux.field_objects.typography.previewShadow(l),e("#"+l+" .typography-style select2-selection__rendered").text(e("#"+l+" .redux-typography-style option:selected").text()),e("#"+l+" .typography-script select2-selection__rendered").text(e("#"+l+" .redux-typography-subsets option:selected").text()),x&&e("#"+l+" .typography-preview").css("text-align",x),v&&e("#"+l+" .typography-preview").css("text-transform",v),m&&e("#"+l+" .typography-preview").css("font-variant",m),b&&e("#"+l+" .typography-preview").css("text-decoration",b),e("#"+l+" .typography-preview").slideDown()}e("#"+l).hasClass("typography-initialized")||e("#"+l).addClass("typography-initialized"),a=!1,o||redux_change(s)}}(jQuery);