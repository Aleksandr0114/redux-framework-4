!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var t=[],a=!1;redux.field_objects.typography.init=function(r,o){r||(r=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(r).each(function(){var r=e(this),o=r;r.hasClass("redux-field-container")||(o=r.parents(".redux-field-container:first")),o.is(":hidden")||o.hasClass("redux-field-init")&&(o.removeClass("redux-field-init"),r.each(function(){r.parents(".redux-container").data("opt-name");e(this).find(".redux-typography-container").each(function(){redux.field_objects.typography.sliderInit(r);var o=e(this).find(".redux-typography-family"),s=o.data("value");void 0===s?o=e(this):""!==s&&e(o).val(s);var p=[{id:"none",text:"none"}],y=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),i=e("#"+y+" .redux-typography-font-family").data("user-fonts");i=i?1:0;var l=e("#"+y+" .redux-typography-google").val();l=l?1:0;var d=[];if(void 0!==redux.optName.customfonts&&d.push(redux.optName.customfonts),void 0!==redux.optName.typekitfonts&&d.push(redux.optName.typekitfonts),void 0!==redux.optName.stdfonts&&0===i&&d.push(redux.optName.stdfonts),1===i){var h=[];for(var n in redux.optName.typography[y]){var u=redux.optName.typography[y].std_font;for(var g in u)u.hasOwnProperty(g)&&h.push({id:g,text:g,"data-google":"false"})}var c={text:"Standard Fonts",children:h};d.push(c)}(1===l||l===!0&&void 0!==redux.optName.googlefonts)&&d.push(redux.optName.googlefonts),p=d;var f=e(this).find(".redux-typography-family").data("value");e(this).find(".redux-typography-family").select2({data:p}),e(this).find(".redux-typography-family").val(f).trigger("change");var x=r.find(".redux-typography-family");x.hasClass("redux-typography-family")||r.find(".redux-typography-style").select2(),e(this).find(".redux-typography-align").select2(),e(this).find(".redux-typography-family-backup").select2(),e(this).find(".redux-typography-transform").select2(),e(this).find(".redux-typography-font-variant").select2(),e(this).find(".redux-typography-decoration").select2(),redux.field_objects.typography.select(o,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var o=e(this).attr("id");if(e(this).hasClass("redux-typography-family")){if(e("#"+o).val()){var s,p=e(this).select2("data");s=p?p[0].text:null,e("#"+o).data("value",s),t=p[0],a=!0,redux.field_objects.typography.select(e("#"+o),!0,!1,s,!0)}}else r=e("#"+o).val(),e("#"+o).data("value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(e("#"+o+' option[selected="selected"]').removeAttr("selected"),e("#"+o+' option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&e("#"+o).siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1)}),e(this).find(".redux-typography-margin-top, .redux-typography-margin-bottom, .redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),e(this).find(".redux-typography-color, .redux-typography-shadow-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(t,a){var r=e(this).attr("id");e("#"+r).data("value",""),e(this).hasClass("redux-typography-family")?(e(this).val(null).trigger("change"),redux.field_objects.typography.select(e("#"+r),!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+r+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&e("#"+r).siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&e("#"+r).val(null).trigger("change"),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),window.onbeforeunload=null})}))})},redux.field_objects.typography.sliderInit=function(t){t.find(".redux-typography-slider").each(function(){var a=e(this).data("id"),r=e(this).data("min"),o=e(this).data("max"),s=e(this).data("step"),p=e(this).data("default"),y=e(this).data("label"),i=Boolean(e(this).data("rtl")),l=[r,o],d=e(this).noUiSlider({range:l,start:p,handles:1,step:s,connect:"lower",behaviour:"tap-drag",rtl:i,serialization:{resolution:1},slide:function(){e(this).next("#redux-slider-value-"+a).attr("value",d.val()),e(this).prev("label").html(y+":  <strong>"+d.val()+"px</strong>"),redux.field_objects.typography.select(t)}})})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.margin_top=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.margin_bottom=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&e!==!1&&0!==e&&("true"===e||"1"===e||e===!0||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";if(""!==e){e=e.replace("#","");var a=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16),s=(299*a+587*r+114*o)/1e3;t=s>=128?"#444444":"#ffffff"}return t},redux.field_objects.typography.select=function(r,o,s,p,y){var i;i=e(r).parents(".redux-container-typography:first").data("id"),void 0===i&&(i=e(r).data("id"));var l=e("#"+i+"-family").val();l||(l=null),p&&(l=p);var d,h=e("#"+i+" select.redux-typography-family-backup").val(),n=e("#"+i+" .redux-typography-size").val(),u=e("#"+i+" .redux-typography-margin-top").val(),g=e("#"+i+" .redux-typography-margin-bottom").val(),c=e("#"+i+" .redux-typography-height").val(),f=e("#"+i+" .redux-typography-word").val(),x=e("#"+i+" .redux-typography-letter").val(),v=e("#"+i+" select.redux-typography-align").val(),m=e("#"+i+" select.redux-typography-transform").val(),b=e("#"+i+" select.redux-typography-font-variant").val(),w=e("#"+i+" select.redux-typography-decoration").val(),_=e("#"+i+" select.redux-typography-style").val(),C=e("#"+i+" select.redux-typography-subsets").val(),j=e("#"+i+" .redux-typography-color").val(),k=e("#"+i).data("units"),N=e("#"+i+" .redux-typography-shadow-color").val(),z=e("#redux-slider-value-"+i+"-h").val(),I=e("#redux-slider-value-"+i+"-v").val(),O=e("#redux-slider-value-"+i+"-b").val();if(a===!0?(d=redux.field_objects.typography.makeBool(t["data-google"]),e("#"+i+" .redux-typography-google-font").val(d)):d=redux.field_objects.typography.makeBool(e("#"+i+" .redux-typography-google-font").val()),y){e("#"+i).hasClass("typography-initialized")||(_=e("#"+i+" select.redux-typography-style").data("value"),C=e("#"+i+" select.redux-typography-subsets").data("value"),""!==_&&(_=String(_)),void 0!==typeof C&&(C=String(C))),void 0===redux.optName.fonts.google&&(d=!1);var B=!1,P="";if(d===!0&&l in redux.optName.fonts.google?P=redux.optName.fonts.google[l]:void 0!==redux.optName.fonts.typekit&&l in redux.optName.fonts.typekit?(B=!0,P=redux.optName.fonts.typekit[l]):P={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(r).hasClass("redux-typography-subsets")&&e("#"+i+" input.typography-subsets").val(C),e(r).hasClass("redux-typography-family")){var S='<option value=""></option>',F="";d===!0?(e.each(P.variants,function(e,t){t.id===_||1===redux.field_objects.typography.size(P.variants)?(F=' selected="selected"',_=t.id):F="",S+='<option value="'+t.id+'"'+F+">"+t.name.replace(/\+/g," ")+"</option>"}),s&&e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(S),e("#"+i+" .redux-typography-style").select2(),F="",S='<option value=""></option>',e.each(P.subsets,function(t,a){a.id===C||1===redux.field_objects.typography.size(P.subsets)?(F=' selected="selected"',C=a.id,e("#"+i+" input.typography-subsets").val(C)):F="",S+='<option value="'+a.id+'"'+F+">"+a.name.replace(/\+/g," ")+"</option>"}),s&&e("#"+i+" .redux-typography-subsets").select2("destroy"),e("#"+i+" .redux-typography-subsets").html(S),e("#"+i+" .redux-typography-subsets").select2(),e("#"+i+" .redux-typography-subsets").parent().fadeIn("fast"),e("#"+i+" .typography-family-backup").fadeIn("fast")):B===!0?(e.each(P.variants,function(e,t){t.id===_||1===redux.field_objects.typography.size(P.variants)?(F=' selected="selected"',_=t.id):F="",S+='<option value="'+t.id+'"'+F+">"+t.name.replace(/\+/g," ")+"</option>"}),e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(S),e("#"+i+" .redux-typography-style").select2(),e("#"+i+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+i+" .typography-family-backup").fadeOut("fast")):P&&(e.each(P,function(t,a){t===_||"normal"===t?(F=' selected="selected"',e("#"+i+" .typography-style select2-selection__rendered").text(a)):F="",S+='<option value="'+t+'"'+F+">"+a.replace("+"," ")+"</option>"}),s&&e("#"+i+" .redux-typography-style").select2("destroy"),e("#"+i+" .redux-typography-style").html(S),e("#"+i+" .redux-typography-style").select2(),e("#"+i+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+i+" .typography-family-backup").fadeOut("fast")),e("#"+i+" .redux-typography-font-family").val(l)}else e(r).hasClass("redux-typography-family-backup")&&""!==h&&e("#"+i+" .redux-typography-font-family-backup").val(h)}y&&(0===e("#"+i+" select.redux-typography-style option[value='"+_+"']").length?(_="",e("#"+i+" select.redux-typography-style").val("").trigger("change")):"400"===_&&e("#"+i+" select.redux-typography-style").val(_).trigger("change"),0===e("#"+i+" select.redux-typography-subsets option[value='"+C+"']").length&&(C="",e("#"+i+" select.redux-typography-subsets").val("").trigger("change"),e("#"+i+" input.typography-subsets").val(C)));var W="style_link_"+i;if(e("."+W).remove(),null!==l&&"inherit"!==l&&e("#"+i).hasClass("typography-initialized")){var A=l.replace(/\s+/g,"+");if(d===!0){var M=A;_&&""!==_&&(M+=":"+_.replace(/\-/g," ")),C&&""!==C&&(M+="&subset="+C),a===!1&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[M]}}),e("#"+i+" .redux-typography-google").val(!0)}else e("#"+i+" .redux-typography-google").val(!1)}if(_.indexOf("italic")!==-1?(e("#"+i+" .typography-preview").css("font-style","italic"),e("#"+i+" .typography-font-style").val("italic"),_=_.replace("italic","")):(e("#"+i+" .typography-preview").css("font-style","normal"),e("#"+i+" .typography-font-style").val("")),e("#"+i+" .typography-font-weight").val(_),c||(c=n),""===n||void 0===n?e("#"+i+" .typography-font-size").val(""):e("#"+i+" .typography-font-size").val(n+k),""===u||void 0===u?e("#"+i+" .typography-margin-top").val(""):e("#"+i+" .typography-margin-top").val(u),""===g||void 0===g?e("#"+i+" .typography-margin-bottom").val(""):e("#"+i+" .typography-margin-bottom").val(g),""===c||void 0===c?e("#"+i+" .typography-line-height").val(""):e("#"+i+" .typography-line-height").val(c+k),""===f||void 0===f?e("#"+i+" .typography-word-spacing").val(""):e("#"+i+" .typography-word-spacing").val(f+k),""===x||void 0===x?e("#"+i+" .typography-letter-spacing").val(""):e("#"+i+" .typography-letter-spacing").val(x+k),e("#"+i).hasClass("typography-initialized")){var D=e("#"+i+" .typography-preview").data("preview-size");"0"===D&&e("#"+i+" .typography-preview").css("font-size",n+k),e("#"+i+" .typography-preview").css("font-weight",_),e("#"+i+" .typography-preview").css("font-family",l+", sans-serif"),"none"===l&&""===l&&e("#"+i+" .typography-preview").css("font-family","inherit"),e("#"+i+" .typography-preview").css("line-height",c+k),e("#"+i+" .typography-preview").css("word-spacing",f+k),e("#"+i+" .typography-preview").css("letter-spacing",x+k),j&&e("#"+i+" .typography-preview").css("color",j),N&&e("#"+i+" .typography-preview").css("text-shadow",z+"px "+I+"px "+O+"px "+N),e("#"+i+" .typography-style select2-selection__rendered").text(e("#"+i+" .redux-typography-style option:selected").text()),e("#"+i+" .typography-script select2-selection__rendered").text(e("#"+i+" .redux-typography-subsets option:selected").text()),v&&e("#"+i+" .typography-preview").css("text-align",v),m&&e("#"+i+" .typography-preview").css("text-transform",m),b&&e("#"+i+" .typography-preview").css("font-variant",b),w&&e("#"+i+" .typography-preview").css("text-decoration",w),e("#"+i+" .typography-preview").slideDown()}e("#"+i).hasClass("typography-initialized")||e("#"+i).addClass("typography-initialized"),a=!1,o||redux_change(r)}}(jQuery);